var mySuning=mySuning||{mySuningFavoriteNoticePartnumber:null,mySuningFavoriteNoticeShopId:null,mySuningFavoriteNoticeEntrace:null};var esjs=document.getElementsByTagName("script");var escss=document.getElementsByTagName("link");var version;function isInclude(a,c){if(c){for(var b=0;b<esjs.length;b++){if(esjs[b][c?"src":"href"].indexOf(a)!=-1){return true}}return false}else{for(var b=0;b<escss.length;b++){if(escss[b][c?"src":"href"].indexOf(a)!=-1){return true}}return false}}$(document).ready(function(){if(!isInclude("jquery",true)){alert("请引入jQuery.js")}$("script").each(function(){if($(this).attr("src")!=null&&typeof($(this).attr("src"))!=undefined&&$(this).attr("src")!=undefined&&$(this).attr("src").indexOf("favorite-api")!=-1){if($(this).attr("src").indexOf("?")<=0){version=""}else{version=$(this).attr("src").substring($(this).attr("src").indexOf("?"))}return false}});if(!isInclude("passport",true)){var c='<script>var passport_config = { base: "http://favorite.suning.com/", loginTheme: "b2c_pop" };<\/script>';$("title").after(c);var a=document.createElement("script");a.src="https://passport.suning.com/ids/js/passport.js";a.type="text/javascript";var b=document.getElementsByTagName("head")[0];b.appendChild(a)}var d=window.location.protocol;if(!isInclude("SFE.dialog",true)){var a=document.createElement("script");if(d=="http:"){a.src="http://res.suning.cn/project/myfavorite/js/SFE.dialog.js"}else{a.src="https://sslres.suning.com/project/myfavorite/js/SFE.dialog.js"}a.type="text/javascript";var b=document.getElementsByTagName("head")[0];b.appendChild(a)}if(!isInclude("jquery.cookie",true)){var a=document.createElement("script");if(d=="http:"){a.src="http://res.suning.cn/project/myfavorite/js/jquery.cookie.min.js"}else{a.src="https://sslres.suning.com/project/myfavorite/js/jquery.cookie.min.js"}a.type="text/javascript";var b=document.getElementsByTagName("head")[0];b.appendChild(a)}});mySuning.requestDialog=function(a,b){$.ajax({url:a+b,type:"GET",dataType:"script",async:false,cache:false})};function favoriteCallback(a){$.mDialog({css:{width:"450px"},http:function(b,c){b.find(".content").html(a.htmlDom)},overlayCss:{background:"black ",opacity:"0.3"},title:"温馨提示"});$.mDialog({css:{width:"450px"},message:$(".dialog-addfavor"),overlayCss:{background:"black",opacity:"0.3"},overlayClick:true,fadeIn:300,fadeOut:300})}function fiftyCallBack(a){$.mDialog({css:{width:"450px"},http:function(b,c){b.find(".content").html(a.htmlDom);mySuning.getRecommendedData("1-2",globalPartNumber,"mySuning.myRecommedData");$("#noticeDiv").css("display","none");$(".netuser-showWin-title").css("display","block");$("#tipmessage").css("display","none");if(noticeType=="priceDown"){$(".netuser-showWin-title").html("<h3>您已订阅满50次的降价通知</h3>")}else{if(noticeType=="arrival"){$(".netuser-showWin-title").html("<h3>您已订阅满50次的到货通知</h3>")}}},overlayCss:{background:"black ",opacity:"0.3"},title:"温馨提示"})}function twoCallBack(a){$.mDialog({css:{width:"450px"},http:function(b,c){b.find(".content").html(a.htmlDom);mySuning.getRecommendedData("1-2",globalPartNumber,"mySuning.myRecommedData");$("#noticeDiv").css("display","none");$(".netuser-showWin-title").css("display","block");$("#tipmessage").css("display","none");if(noticeType=="priceDown"){$(".netuser-showWin-title").html("<h3>您已订阅过该商品的降价通知</h3>")}else{if(noticeType=="arrival"){$(".netuser-showWin-title").html("<h3>您已订阅过该商品的到货通知</h3>")}}},overlayCss:{background:"black ",opacity:"0.3"},title:"温馨提示"})}function noticeCallBack(a){$.mDialog({css:{width:"470px"},http:function(b,c){b.find(".content").html(a.htmlDom);if(noticeType=="priceDown"){$("#expectPrice").val(parseInt(globalPartPrice));if(globalEntrance=="myFavorite"||globalEntrance=="myFavoritePic"){$("#isFavoriteAdd").css("display","none")}$(".exOrder-show-win").css("display","none")}else{if(noticeType=="arrival"){if(globalEntrance=="myFavorite"||globalEntrance=="myFavoritePic"){$("#isFavoriteAdd").css("display","none")}else{$("#check-addfav").attr("checked","checked")}$("#arrival_text").css("display","block");$("#priceLi").css("display","none");$(".exOrder-show-win").css("display","none")}}},overlayCss:{background:"black ",opacity:"0.3"},title:titleName})}mySuning.doSuccess=function(c,d,h,f,a,e){var g=c;if(g.returnCode==0||g.returnCode==1){if(d=="product"){b="http://favorite.suning.com/ajax/productFavoriteSuccessLayer.do?partnumber="+h+"&shopId="+f+"&callback=";mySuning.requestDialog(b,"favoriteCallback");if(e){$("#spsc_cksc").attr("name",e+"_spsc_cksc");$("#spsc_bjbq").attr("name",e+"_spsc_bjbq")}}else{if(d=="shop"){b="http://favorite.suning.com/ajax/shopFavoriteSuccessLayer.do?shopId="+f+"&entrance="+a+"&callback=";mySuning.requestDialog(b,"favoriteCallback");if(e){$("#dpsc_cksc").attr("name",e+"_dpsc_cksc");$("#dpsc_bjbq").attr("name",e+"_dpsc_bjbq")}}}}else{if(g.returnCode==100){}else{var b="http://favorite.suning.com/ajax/"+d+"FavoriteFailLayer.do?entrance="+a+"&callback=";mySuning.requestDialog(b,"favoriteCallback")}}};mySuning.doGET=function(b,c,g,e,a,d){$.ajax({type:"GET",async:false,url:b,dataType:"jsonp",jsonpCallback:"myCallback",success:function f(h){mySuning.doSuccess(h,c,g,e,a,d)}})};mySuning.doJsonpGET=function(a,b){$.ajax({type:"GET",async:false,url:a,dataType:"jsonp",jsonpCallback:b})};mySuning.add2ProductFavorite=function(f,d,a,g,c){globalEntrance=a;globalShopId=d;ajaxUrl=window.location.href;var e=/^[0-9]{18}$/;var b=/^[0-9]{10}$/;if(!(e.test(f)&&b.test(d))){alert("传入参数不正确");return}if("shoppingCart1shopping"==a){url="https://favorite.suning.com/ajax/addProductFavorite.do?partnumber="+f+"&shopId="+d+"&entrance="+a}else{url="http://favorite.suning.com/ajax/addProductFavorite.do?partnumber="+f+"&shopId="+d+"&entrance="+a}probeAuthStatus(function(){if(g){mySuning.doJsonpGET(url,g)}else{mySuning.doGET(url,"product",f,d,c)}},function(){ensureLogin(function(){mySuning.add2ProductFavorite(f,d,a,g,c)})})};mySuning.add2ShopFavorite=function(d,a,c){globalEntrance=a;var b=/^[0-9]{10}$/;if(!b.test(d)){alert("传入参数不正确");return}url="http://favorite.suning.com/ajax/addShopFavorite.do?shopId="+d+"&entrance="+a;probeAuthStatus(function(){mySuning.doGET(url,"shop","",d,a,c)},function(){ensureLogin(function(){mySuning.add2ShopFavorite(d,a,c)})})};var tel=/^[a-zA-Z0-9_\u4e00-\u9fa5]{0,10}$/;mySuning.addTag=function(b,a){var d=encodeURI(b);$.ajax({type:"GET",async:false,url:d,dataType:"jsonp",jsonpCallback:"myCallback",success:function c(e){var f=e;if(f.returnCode==0){a.find("#btns").css("display","none");a.find("#ok").css("display","block");setTimeout(function(){$.unmDialog()},2000)}else{if(f.returnCode=1){a.find("#error").css("display","block")}else{if(f.returnCode=-2){a.find("#notRight").css("display","block")}}}}})};mySuning.addTag1=function(b,a){var d=encodeURI(b);$.ajax({type:"GET",async:false,url:d,dataType:"jsonp",jsonpCallback:"myCallback",success:function c(e){var f=e;if(f.returnCode==0){a.find(".add-sign").find("a").remove();a.find(".error-ok").css("display","block");setTimeout(function(){$.unmDialog()},2000)}else{if(f.returnCode=1){a.find(".error-msg").html("添加标签失败！");a.find(".error-msg").css("display","block");a.find("a").prev().addClass("error-tbx")}else{if(f.returnCode=-2){a.find(".error-msg").html("标签应为10个以内的中文、数字、字母或下划线！");a.find(".error-msg").css("display","block");a.find("a").prev().addClass("error-tbx")}}}}})};mySuning.productFavoriteAndTag=function(c){var f=$(c).parent().parent();f.find("#error").css("display","none");var i=f.parent().find("input");var b=i.attr("id");var e=f.find("i");var h=$(c).parent().find(".partnumber").attr("id");var g=$(c).parent().find(".shopId").attr("id");var d="notOpen";if(typeof(i.val())==undefined||i.val()==""||i.val()==null){return}else{if(tel.test(i.val())){f.find("#notRight").css("display","none");f.find("#error").css("display","none");var a="http://favorite.suning.com/ajax/addProductTag.do?partnumber="+h+"&shopId="+g+"&open="+d+"&productTagName="+i.val()+"&oldTagName="+b;ensureLogin(function(){mySuning.addTag(a,f)})}else{f.find("#notRight").css("display","block");return}}};mySuning.productFavoriteAndTag1=function(g){var e=$(g).parent().parent();var a=$(g).prev();if(a.val()=="您还可以自定义标签 (10字以内)"){return}else{var d=a.attr("id");var h=$(g).parent().find(".partnumber").attr("id");var f=$(g).parent().find(".shopId").attr("id");var c="notOpen";if(typeof(a.val())==undefined||a.val()==""||a.val()==null){return}else{if(tel.test(a.val())){var b="http://favorite.suning.com/ajax/addProductTag.do?partnumber="+h+"&shopId="+f+"&open="+c+"&productTagName="+a.val()+"&oldTagName="+d;probeAuthStatus(function(){mySuning.addTag1(b,e)},function(){ensureLogin(function(){mySuning.addTag1(b,e)})})}else{e.find(".error-msg").html("标签应为10个以内的中文、数字、字母或下划线！");e.find(".error-msg").css("display","block");a.addClass("error-tbx");return}}}};mySuning.shopFavoriteAndTag=function(g){var e=$(g).parent().parent();e.find("#error").css("display","none");var a=e.parent().find("input");var d=a.attr("id");var c=e.find("i");var f=$(g).parent().find(".shopId").attr("id");if(typeof(a.val())==undefined||a.val()==""||a.val()==null){return}else{if(tel.test(a.val())){e.find("#notRight").css("display","none");e.find("#error").css("display","none");var b="http://favorite.suning.com/ajax/addShopTag.do?&shopId="+f+"&shopTagName="+a.val();ensureLogin(function(){mySuning.addTag(b,e)})}else{e.find("#notRight").css("display","block");return}}};mySuning.shopFavoriteAndTag1=function(f){var d=$(f).parent().parent();var a=$(f).prev();if(a.val()=="您还可以自定义标签 (10字以内)"){return}else{var c=a.attr("id");var e=$(f).parent().find(".shopId").attr("id");if(typeof(a.val())==undefined||a.val()==""||a.val()==null){return}else{if(tel.test(a.val())){var b="http://favorite.suning.com/ajax/addShopTag.do?&shopId="+e+"&shopTagName="+a.val()+"&oldTagName="+c;probeAuthStatus(function(){mySuning.addTag1(b,d)},function(){ensureLogin(function(){mySuning.addTag1(b,d)})})}else{d.find(".error-msg").html("标签应为10个以内的中文、数字、字母或下划线！");d.find(".error-msg").css("display","block");a.addClass("error-tbx");return}}}};mySuning.onerr=function(a,b){a.css("display","block");a.html("<i></i><label>"+b+"</label>")};mySuning.validatePrice=function(b,c){var a=/^[1-9]\d*$/;var d=c.val();if(d==undefined||d==""){mySuning.onerr(b,"期望价格不能为空");$("#expectPrice").css("border-color","#ff0000");return false}else{if(!a.test(d)){mySuning.onerr(b,"期望价格必须是正数");return false}if(Number(d)>Number(globalPartPrice)){mySuning.onerr(b,"期望价格不能高于原价");return false}else{return true}}return true};mySuning.validateMobile=function(e,a){var d=/^1\d{10}$/;var c=a.val();var b=$("#email").val();if((c==undefined||c=="")&&(b==undefined||b=="")){$("#emailMobileErr").css("display","block");return false}else{if(c.length>0){if(c.length!=11||!d.test(c)){$("#emailMobileErr").css("display","none");mySuning.onerr(e,"手机号码输入格式错误");return false}return true}else{return true}}};mySuning.validateEmail=function(e,a){var d=/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/;var c=a.val();var b=$("#fMobileNumber").val();if((c==undefined||c=="")&&(b==undefined||b=="")){$("#emailMobileErr").css("display","block");return false}else{if(c.length>0){if(c.length>50||!d.test(c)){if(c.match(/(\s+)/)&&c.match(/@/)&&c.match(/\./)){$("#emailMobileErr").css("display","none");mySuning.onerr(e,"邮箱不能包含空格！")}else{mySuning.onerr(e,"邮箱地址输入格式错误");$("#emailMobileErr").css("display","none")}return false}return true}else{return true}}};mySuning.fcus=function(b,a){b.css("display","none");if(null!=a){a.css("display","none")}if("error1"!=b.attr("id")&&$("#errorMobile").css("display")=="none"&&$("#error2").css("display")=="none"){$("#emailMobileErr").css("display","block")}};mySuning.clickNotice=function(c,b){var a;if(noticeType=="priceDown"){a="http://favorite.suning.com/ajax/fourPage/checkCountPrice.do"}else{if(noticeType=="arrival"){a="http://favorite.suning.com/ajax/fourPage/checkCountArrival.do"}}ensureLogin(function(){$.ajax({type:"GET",async:false,url:a+"?partnumber="+c+"&shopId="+b,dataType:"jsonp",jsonpCallback:"myCallbacknotice",success:function d(f){var g=f.bookFlag;var e;if(g==2){e="http://favorite.suning.com/ajax/fourPage/clickAlertPrice.do?callback=",mySuning.requestDialog(e,"fiftyCallBack")}else{if(g==1){e="http://favorite.suning.com/ajax/fourPage/clickAlertPrice.do?partnumber="+globalPartNumber+"&shopId="+globalShopId+"&entrance="+globalEntrance+"&callback=",mySuning.requestDialog(e,"twoCallBack")}else{if(g==0){thisMfCityId=f.cityId;if(noticeType=="priceDown"){titleName="降价通知"}else{if(noticeType=="arrival"){titleName="到货通知"}else{titleName="温馨提示"}}var h;h="http://favorite.suning.com/ajax/fourPage/clickAlertPrice.do";e=h+"?partnumber="+globalPartNumber+"&shopId="+globalShopId+"&entrance="+globalEntrance+"&callback=",mySuning.requestDialog(e,"noticeCallBack")}}}}})})};mySuning.myClickPrice=function(g,d,f,b,e,a){var c=mySuning.validatePrice(g,d);var b=mySuning.validateEmail(f,b);var a=mySuning.validateMobile(e,a);if(noticeType=="priceDown"){if(c&&b&&a){mySuning.fromSubmit()}}else{if(b&&a){mySuning.fromSubmit()}}};mySuning.myClickArrival=function(b,a){var a=mySuning.validateEmail(b,a);if(a&&cityflag){mySuning.fromSubmit($(" #arrivalEmail"))}};mySuning.fromSubmit=function(){var c=$(" #email");var g=$(" #expectPrice");var b=$(" #fMobileNumber");if(noticeType=="priceDown"){var f=g.val()}var d;var a=c.val();var e=b.val();if(globalEntrance=="myFavorite"||globalEntrance=="myFavoritePic"){d=false}else{if($("#check-addfav").attr("checked")=="checked"){d=true}else{d=false}}var h;if(noticeType=="priceDown"){h="http://favorite.suning.com/ajax/myFavorite/addProductPriceNotice.do?expectedPrice="+f+"&price="+globalPartPrice+"&email="+a+"&mobilePhone="+e}else{if(noticeType=="arrival"){h="http://favorite.suning.com/ajax/myFavorite/addProductArrivalNotice.do?email="+a+"&mobilePhone="+e}}probeAuthStatus(function(){$.ajax({type:"GET",url:h+"&&partnumber="+globalPartNumber+"&&shopId="+globalShopId+"&entrance="+globalEntrance,dataType:"jsonp",jsonpCallback:"myCallbacknotice",success:function i(j){if(j.returnCode==-1){$.unmDialog();ensureLogin(function(){})}else{var k=j.returnMsg;if(k==undefined||k==""){if(d){mySuning.mySuningFavoriteNoticePartnumber=globalPartNumber;mySuning.mySuningFavoriteNoticeShopId=globalShopId;mySuning.mySuningFavoriteNoticeEntrace=globalEntrance;mySuning.add2ProductFavorite(globalPartNumber,globalShopId,globalEntrance,"mySuningFavoriteShowNoticesSuccessCallback")}else{mySuning.showNoticeSuccess(globalPartNumber,globalShopId,"'"+globalEntrance+"'")}}else{mySuning.onerr($("#messagePrice"),k)}}},error:function(){if(noticeType=="priceDown"){mySuning.onerr($("#messagePrice"),"系统异常")}else{if(noticeType=="arrival"){mySuning.onerr($("#messageArrival"),"系统异常")}}}})},function(){$.unmDialog();ensureLogin(function(){})})};mySuningFavoriteShowNoticesSuccessCallback=function(){mySuning.showNoticeSuccess(mySuning.mySuningFavoriteNoticePartnumber,mySuning.mySuningFavoriteNoticeShopId,"'"+mySuning.mySuningFavoriteNoticeEntrace+"'");mySuning.mySuningFavoriteNoticePartnumber=null;mySuning.mySuningFavoriteNoticeShopId=null;mySuning.mySuningFavoriteNoticeEntrace=null};mySuning.showNoticeSuccess=function(b,a,c){mySuning.getRecommendedData("1-2",b,"mySuning.myRecommedData");$("#noticeDiv").css("display","none");$("#noticeSuccess").css("display","block");if(noticeType=="priceDown"){$(".netuser-showWin-title").html("<h3>商品订阅降价通知成功</h3>");$("#tipmessage").html("商品一旦在30日内降价，我们将会第一时间通知您，请及时关注哦！")}else{if(noticeType=="arrival"){$(".netuser-showWin-title").html("<h3>商品订阅到货通知成功</h3>");$("#tipmessage").html("");if(c=="'myFavorite'"){var d=$("#prod"+b+"_"+a).find(".prod-edit .sn-btn");d.html("已订阅");d.attr("title","已订阅到货通知");d.attr("href","javascript:void(0);")}if(c=="'myFavoritePic'"){var d=$("#prod"+b+"_"+a).find(".cost-pic a");d.html("已订阅");d.attr("title","已订阅到货通知");d.attr("href","javascript:void(0);")}}}};mySuning.subscribePriceNotice=function(d,c,b,a){noticeType="priceDown";globalPartPrice=b;globalPartNumber=d;globalShopId=c;globalEntrance=a;ajaxUrl=window.location.href;ensureLogin(function(){mySuning.clickNotice(d,c)})};mySuning.subscribeArrivalNotice=function(c,b,a){noticeType="arrival";globalPartNumber=c;globalShopId=b;globalEntrance=a;ajaxUrl=window.location.href;ensureLogin(function(){mySuning.clickNotice(c,b)})};mySuning.cityValidate=function(b){favoriteCityId=b.find("#inputCityId").val();if(!favoriteCityId||favoriteCityId==""){favoriteCityId=thisMfCityId}var a;if(noticeType=="priceDown"){a="http://favorite.suning.com/ajax/myFavorite/checkProductPriceNoticeCity.do"}else{if(noticeType=="arrival"){a="http://favorite.suning.com/ajax/myFavorite/checkProductArrivalNoticeCity.do"}}probeAuthStatus(function(){$.ajax({type:"GET",url:a+"?cityId="+favoriteCityId+"&&partnumber="+globalPartNumber+"&&shopId="+globalShopId,dataType:"jsonp",jsonpCallback:"myCallbacknotice",success:function c(d){if(d.returnCode==-1){$.unmDialog();ensureLogin(function(){})}else{var e=d.returnMsg;if(e&&e!=""){if(noticeType=="priceDown"){mySuning.onerr($("#errorCityMsgPrice"),e)}else{if(noticeType=="arrival"){mySuning.onerr($("#errorCityMsgArrival"),e)}}cityflag=false}else{cityflag=true}}},error:function(){if(noticeType=="priceDown"){mySuning.onerr($("#errorCityMsgPrice"),"系统异常")}else{if(noticeType=="arrival"){mySuning.onerr($("#errorCityMsgArrival"),"系统异常")}}}})},function(){$.unmDialog();ensureLogin(function(){})})};mySuning.getRecommendedData=function(a,g,e){var f;f=$.cookie("cityId");if(f=="cityId=undefined"){var c=document.cookie.split(";");for(var d=0;d<c.length;d++){var b=c[d].split("=");if(b[0]=="cityId"){f=unescape(b[1])}}}if(f==undefined||f==""||f=="cityId=undefined"){f="9173"}$.ajax({type:"get",url:"http://tuijian.suning.com/recommend-portal/recommendv2/biz.jsonp?parameter="+g+"&cityId="+f+"&sceneIds="+a+"&count=12&u=156126",dataType:"jsonp",jsonpCallback:e,cache:true})};mySuning.myRecommedData=function(c){leng=c.sugGoods[0].skus.length;var l="";var a;var k;if(leng>12){leng=12}if(leng>=1){$("#picRecommend").css("display","block");for(var d=0;d<leng;d++){var g=c.sugGoods[0].skus[d].sugGoodsCode;var h=c.sugGoods[0].skus[d].sugGoodsName;var e=c.sugGoods[0].parameter;var p=c.sugGoods[0].skus[d].vendorId;var j=c.sugGoods[0].skus[d].price;var m=c.sugGoods[0].skus[d].handwork;var f;var b;if(noticeType=="priceDown"){b="_recsijijzn_"}else{b="_recsjdhtzn_"}if(globalEntrance=="productDetail"){if(ajaxUrl.indexOf("http://item")==0){f="item_"}else{if(globalShopId!="0000000000"){f="cprd_";if(noticeType=="priceDown"){b="_reccsijijz_"}else{b="_reccsjdhtz_"}}else{f="item_"}}}else{if(globalEntrance=="searchResult"){if(ajaxUrl.indexOf("http://search")==0){f="ssdsn_"}else{f="ssdln_"}}else{f="favorite_"}}var o=f+e.substring(9,18)+b+(Math.floor(d/3)+1)+"-"+(d%3+1)+"_p_"+p+"_"+g.substring(9,18)+"_"+m;var n=f+e.substring(9,18)+b+(Math.floor(d/3)+1)+"-"+(d%3+1)+"_c_"+p+"_"+g.substring(9,18)+"_"+m;l=l+"<li><a  class='fav-pic' title='"+h+"' name='"+o+"' href='http://product.suning.com/"+p+"/"+g.substring(9,18)+".html?src="+o+"' target='_blank'> <img src='http://image.suning.cn/content/catentries/"+g.substring(0,14)+"/"+g+"/"+g+"_ls1.jpg' id='img"+g+"' /></a>    <p class='msg-protitle' style='height:35px; overflow: hidden;'><a name='"+o+"' title='"+h+"' target='_blank'  href='http://product.suning.com/"+p+"/"+g.substring(9,18)+".html?src="+n+"' >"+h+"</a></p> <p class='snPrice'><em class='l'>￥</em><i> "+j+"</i></p> </li>"}$(".movbox-artic").html(l);$(".m-dialog").css("top","30%");mySuning.fav_showPic();if((navigator.userAgent.indexOf("MSIE")>=0)&&(navigator.userAgent.indexOf("Opera")<0)){setTimeout(function(){$(".movpic-shot").find("li").each(function(){var i=$(this).find("img");var q=i.attr("src");i.attr("src","");i.load(function(){var r=i.attr("id");mySuning.zoom(r,100,100)});i.attr("src",q)})},200)}else{$(".movpic-shot").find("li").each(function(){var i=$(this).find("img");var q=i.attr("src");i.attr("src","");i.load(function(){var r=i.attr("id");mySuning.zoom(r,100,100)});i.attr("src",q)})}}else{$("#picRecommend").css("display","none")}};mySuning.productSuccessRecommedCallback=function(q){var d=q.sugGoods[0].skus.length;var j="<ul class='movbox-artic'>";var o;if(globalEntrance=="productDetail"){if(ajaxUrl.indexOf("http://item")==0){o="item_";recommedBuriedPointCollect="_recscollectn_"}else{if(globalShopId!="0000000000"){o="cprd_";recommedBuriedPointCollect="_reccscollect_"}else{o="item_";recommedBuriedPointCollect="_recscollectn_"}}}else{if(globalEntrance=="searchResult"){if(ajaxUrl.indexOf("http://search")==0){o="ssdsn_";recommedBuriedPointCollect="_recstore_"}else{o="ssdln_";recommedBuriedPointCollect="_recstore_"}}else{o="favorite_";recommedBuriedPointCollect="_recscollectn_"}}var e=q.sugGoods[0].parameter;if(d>0){var g=d;if(d>12){g=12}for(var l=0;l<g;l++){var n=q.sugGoods[0].skus[l].sugGoodsCode;var r=q.sugGoods[0].skus[l].vendorId;var p=q.sugGoods[0].skus[l].sugGoodsName;if(p.length>=20){var a=p.substring(0,20)}else{var a=p}var k=q.sugGoods[0].skus[l].price;var s=q.sugGoods[0].skus[l].handwork;var c="http://product.suning.com/"+r+"/"+n.substring(9,18)+".html?src="+o+e.substring(9,18)+recommedBuriedPointCollect+(Math.floor(l/3)+1)+"-"+(l%3+1)+"_p_"+r+"_"+n.substring(9,18)+"_"+s;var m="http://product.suning.com/"+r+"/"+n.substring(9,18)+".html?src="+o+e.substring(9,18)+recommedBuriedPointCollect+(Math.floor(l/3)+1)+"-"+(l%3+1)+"_c_"+r+"_"+n.substring(9,18)+"_"+s;var f="http://image.suning.cn/content/catentries/"+n.substring(0,14)+"/"+n+"/"+n+"_ls1.jpg";var h=o+e.substring(9,18)+recommedBuriedPointCollect+(Math.floor(l/3)+1)+"-"+(l%3+1)+"_p_"+r+"_"+n.substring(9,18)+"_"+s;var b=o+e.substring(9,18)+recommedBuriedPointCollect+(Math.floor(l/3)+1)+"-"+(l%3+1)+"_c_"+r+"_"+n.substring(9,18)+"_"+s;j=j+"<li><a title='"+p+"' name='"+h+"' href='"+c+"' target='_blank' class='fav-pic'><img src='"+f+"' alt='"+p+"' id='img"+n+"'/></a><a href='"+m+"' title='"+p+"'  name='"+b+"' target='_blank' class='fav-msg'>"+p+"</a><span class='fav-price'>&yen;"+k+" </span></li>"}j=j+"</ul>";$(".movpic-shot").html(j);$(".movpic-artic").removeAttr("style");$(".m-dialog").css("top","30%");mySuning.fav_showPic();if((navigator.userAgent.indexOf("MSIE")>=0)&&(navigator.userAgent.indexOf("Opera")<0)){setTimeout(function(){$(".movpic-shot").find("li").each(function(){var i=$(this).find("img");var t=i.attr("src");i.attr("src","");i.load(function(){var u=i.attr("id");mySuning.zoom(u,100,100)});i.attr("src",t)})},200)}else{$(".movpic-shot").find("li").each(function(){var i=$(this).find("img");var t=i.attr("src");i.attr("src","");i.load(function(){var u=i.attr("id");mySuning.zoom(u,100,100)});i.attr("src",t)})}}};mySuning.shopSuccessRecommedCallback=function(k){var a=k.sugGoods[0].skus.length;var p="<ul class='movbox-artic'>";if(a>0){var c="";var d=a;if(a>12){d=12}var e="cprd_";for(var l=0;l<d;l++){var j=k.sugGoods[0].skus[l].sugGoodsName;var n=k.sugGoods[0].parameter;var f=k.sugGoods[0].skus[l].sugGoodsDes;var m=k.sugGoods[0].skus[l].sugGoodsCode;var q=k.sugGoods[0].skus[l].handwork;if(f==undefined||f.length==0){f="http://image.suning.cn/project/myfavorite/images/shop.png"}var o=k.sugGoods[0].skus[l].sugGoodsCode;var h=k.sugGoods[0].skus[l].promotionInfo;if(o.length>8){c=c+o+"_"}var b=e+n+"_recscdp_"+(Math.floor(l/3)+1)+"-"+(l%3+1)+"_p_0000000000_"+m+"_"+q;var g=h+"?src="+b;p=p+'<li id="recmStar'+o+'"><a title="'+j+'" name="'+b+'" href="'+g+'" class="fav-pic" target="_blank"><img src="'+f+'" id="img'+o+'"/></a><p class="msg-protitle"><a href="'+g+'" title="'+j+'" target="_blank">'+j+'</a></p><div class="pro-lvstart"><span class="comment-star"><em style="width:'+5*14+'px;margin-top:0"></em></span></div></li>'}p=p+"</ul>";$(".movpic-shot").html(p);$(".movpic-artic").removeAttr("style");$(".m-dialog").css("top","30%");mySuning.fav_showPic();if((navigator.userAgent.indexOf("MSIE")>=0)&&(navigator.userAgent.indexOf("Opera")<0)){setTimeout(function(){$(".movpic-shot").find("li").each(function(){var i=$(this).find("img");var r=i.attr("src");i.attr("src","");i.load(function(){var s=i.attr("id");mySuning.zoom(s,100,100)});i.attr("src",r)})},200)}else{$(".movpic-shot").find("li").each(function(){var i=$(this).find("img");var r=i.attr("src");i.attr("src","");i.load(function(){var s=i.attr("id");mySuning.zoom(s,100,100)});i.attr("src",r)})}mySuning.getShopStarsJsonp(c)}};mySuning.getShopStarsJsonp=function(c){var b="http://favorite.suning.com/ajax/getShopStarsJsonp.do?shopIdStr="+c;$.ajax({type:"get",url:b,async:false,dataType:"jsonp",jsonpCallback:"myCallbackStars",success:function a(g){var d=0;for(var e in g){var f=(g[e].shopStar/5*69).toFixed(2);$("#recmStar"+g[e].supplierCode).find("em").attr("style","width:"+f+"px")}}})};mySuning.subscribeArrivalNoticeCheck=function(g,f,c,a,e){var b="http://favorite.suning.com/ajax/fourPage/checkCountArrival.do";$.ajax({type:"GET",async:false,url:b+"?partnumber="+g+"&shopId="+f,dataType:"jsonp",jsonpCallback:"myCallbacknotice",success:function d(j){var k=j.bookFlag;var h;if(k==2){showMsg("订阅已满50次，无法订阅！")}else{if(k==0){var l="http://favorite.suning.com/ajax/myFavorite/addProductArrivalNotice.do?mobilePhone="+e;$.ajax({type:"GET",url:l+"&&partnumber="+g+"&&shopId="+f+"&mdmCityCode="+c+"&entrance="+a+"&channel=2",dataType:"jsonp",jsonpCallback:"myCallbacknotice",success:function i(m){var n=m.returnMsg;if(n==undefined||n==""){showMsg("订阅成功，请耐心等待！")}else{showMsg("订阅失败，系统异常！")}},error:function(){showMsg("订阅失败，系统异常！")}})}}}})};mySuning.zoom=function(a,e,f){$("#"+a).css("width","");$("#"+a).css("height","");var g=$("#"+a).width();var h=$("#"+a).height();if((e/f)>(g/h)){$("#"+a).width((f*g)/h);$("#"+a).height(f);var c=(e-$("#"+a).width())/2;var b=(f-$("#"+a).height())/2;$("#"+a).css("margin-top",b);$("#"+a).css("margin-left",c);$("#"+a).css("margin-right",c-1)}else{$("#"+a).width(e);$("#"+a).height((e*h)/g);var d=(f-$("#"+a).height())/2;var i=($("#"+a).width())/2;$("#"+a).css("margin-top",d)}};var spacing=118;var page=1;var setUpCovers=function(){var a;a=parseInt(leng/3);$(".pageNum").html("/"+a);var b=$(".covers").last();var c=b.find(".covers_a");$(".btn_forLeft").die("click");$(".btn_forRight").die("click");c.eq(0).css("left","0");c.eq(1).css("left",spacing);c.eq(2).css("left",spacing*2);$(".btn_forLeft").live("click",function(e){var d=$(".covers").last();var f=d.find(".covers_a");f.eq(2).animate({left:spacing*5},"fast");f.eq(1).animate({left:spacing*4},"fast");f.eq(0).animate({left:spacing*3},"fast");f.eq(f.length-1).css("left",(-spacing)).animate({left:spacing*2},"fast");f.eq(f.length-2).css("left",(-spacing)*2).animate({left:spacing},"fast");f.eq(f.length-3).css("left",(-spacing)*3).animate({left:0},"fast",function(){f.eq(f.length-1).prependTo(".covers");f.eq(f.length-2).prependTo(".covers");f.eq(f.length-3).prependTo(".covers");setUpCovers()});if(page>1){page--}else{page=a}$(".page").html(page);e.preventDefault()});$(".btn_forRight").live("click",function(e){var d=$(".covers").last();var f=d.find(".covers_a");f.eq(0).animate({left:-spacing*3},"fast");f.eq(1).animate({left:-spacing*2},"fast");f.eq(2).animate({left:-spacing},"fast");f.eq(3).css("left",spacing*3).animate({left:0},"fast");f.eq(4).css("left",spacing*4).animate({left:spacing},"fast");f.eq(5).css("left",spacing*5).animate({left:spacing*2},"fast",function(){f.eq(0).appendTo(".covers");f.eq(1).appendTo(".covers");f.eq(2).appendTo(".covers");setUpCovers()});if(page<a){page++}else{page=1}$(".page").html(page);e.preventDefault()})};mySuning.listloop=function(b){var c={wrap:"#brandPromo",loopBox:"#brandPromo-list",triggerLeft:".dir-prev",triggerRight:".dir-next",curCount:".cur-count",totalCount:".total-count",step:{wide:7,narrow:6},scrollWidth:{wide:840,narrow:660},hasCount:true,isLoop:true,isLazyLoad:true,delay:0};$.extend(c,b);var h=$(c.wrap),n=h.find(c.triggerLeft),a=h.find(c.triggerRight),q=h.find(c.loopBox),g=q.find("li"),e=c.step.wide,l=c.scrollWidth.wide,s=Math.ceil(g.length/e),f=g.length,j=h.find(c.curCount),t=h.find(c.totalCount),r=0;if(screen.width<1280){e=c.step.narrow;l=c.scrollWidth.narrow;var u=g.length%e;s=Math.ceil(g.length/e);f=g.length-u}c.hasCount&&t.html(s);n.click(function(){m();return false});a.click(function(){o();return false});function o(){if(s==1||q.is(":animated")){return false}if(!c.isLoop){r++;if(r>=s){r=s-1}p(false,r);return}if(r==s-1){for(var i=0;i<e;i++){g.eq(i).css({position:"relative",left:s*l+"px"})}}r++;p(function(){if(r==s){r=0;g.removeAttr("style");q.css("marginLeft",r*l)}},r)}function m(){if(s==1||q.is(":animated")){return false}if(!c.isLoop){r--;if(r<=0){r=0}p(false,r);return}if(r==0){for(var i=1;i<=e;i++){g.eq(f-i).css({position:"relative",left:-s*l+"px"})}}r--;p(function(){if(r==-1){r=s-1;g.removeAttr("style");q.css("marginLeft",-r*l)}},r)}function p(v,i){k();if(c.hasCount){if(i>s-1){i=0}if(i<0){i=s-1}j.html(i+1)}if(!v){v=function(){}}q.stop().animate({marginLeft:-r*l},500,v)}function k(){if(!c.isLazyLoad){return}for(var v=0;v<e;v++){var i=g.eq(r*e+v).find("img");if(i.attr("src3")){i.attr("src",i.attr("src3")).removeAttr("src3").addClass("err-product")}}}if(c.delay){var d=setInterval(function(){o()},c.delay);h.hover(function(){clearInterval(d)},function(){d=setInterval(function(){o()},c.delay)})}};mySuning.getShopStar=function(c){var b="http://favorite.suning.com/ajax/getShopStar.do?shopId="+c;var a=$.ajax({type:"get",url:b,async:false,dataType:"json",success:function(e){var d=e;return d},error:function(d){return 5}});return a.responseText};mySuning.addCookie=function(a){$.cookie("smhst",a)};mySuning.add2BrandFavorite=function(d,c,a,e,b){probeAuthStatus(function(){var f="http://favorite.suning.com/ajax/addBrandFavorite.do?brandId="+d+"&deptId="+c+"&entrance="+a;if(e){$.ajax({type:"GET",async:false,url:f,dataType:"jsonp",jsonpCallback:e})}else{f=f+"&dialog=1";$.ajax({type:"GET",async:false,url:f,dataType:"jsonp",jsonpCallback:"myBrandFavorWithDialog",success:function g(h){$.mDialog({css:{width:"450px"},http:function(i,j){i.find(".content").html(h.htmlDom)},overlayCss:{background:"black ",opacity:"0.3"},title:"温馨提示"})}})}},function(){ensureLogin(function(){mySuning.add2BrandFavorite(d,c,a,e,b)})})};